var __reflect=this&&this.__reflect||function(e,t,r){e.__class__=t,r?r.push(t):r=[t],e.__types__=e.__types__?r.concat(e.__types__):r},__extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},DefaultPortrait=function(e){function t(t,r,i,n,o){var a=this,s="defaultPortrait_"+t+"_jpg";return a=e.call(this,RES.getRes(s))||this,a.x=r,a.y=i,a.width=n,a.height=o,a.name=t+"",a}return __extends(t,e),t}(egret.Bitmap);__reflect(DefaultPortrait.prototype,"DefaultPortrait");var Socket=function(){function e(){}return e.init=function(e,t){this.ip=e,this.port=t,SocketUtil.init();for(var r=0,i=SocketUtil.socketMiddWareMap;r<i.length;r++){var n=i[r];this.pomelo.on(n.route,n.middWare)}},e.start=function(e,t,r){var i=this,n={host:this.ip,port:this.port,log:!0},o=function(n){i.pomelo.request("gate.gateHandler.queryConn",{uid:e},function(n){i.pomelo.disconnect,200===n.code&&i.initConn(n.host,n.port,e,t,r)})},a=function(e){console.log("connect gate server fail")},s=function(e){console.log("server connect is closed")};this.pomelo.init(n,!1,o,a,s,null)},e.initConn=function(e,t,r,i,n){var o=this,a={host:e,port:t,log:!0},s=function(e){o.pomelo.request("connector.entryHandler.entry",{uid:r,name:i},function(e){n(e)})},h=function(e){console.log("connect connector server fail")},u=function(e){console.log("connector server is closed")};this.pomelo.init(a,!1,s,h,u,null)},e.register=function(e){var t=this,r=e.receive();r.forEach(function(e){t.pomelo.on(e.route,e.cb)})},e.request=function(e,t,r){this.pomelo.request(e,t,r)},e.notify=function(e,t){this.pomelo.notify(e,t)},e.off=function(e){var t=this;e.forEach(function(e){t.pomelo.off(e)})},e.getPomelo=function(){return this.pomelo},e.disconnect=function(){this.pomelo.disconnect()},e}();Socket.pomelo=new Pomelo,__reflect(Socket.prototype,"Socket");var SocketUtil=function(){function e(){}return e.init=function(){this.socketMiddWareMap.push(new SocketMiddWare("roomOtherJoinRoom"))},e.bind=function(e,t){for(var r=0,i=this.socketMiddWareMap;r<i.length;r++){var n=i[r];if(e===n.route){n.setCb(t);break}}},e}();SocketUtil.socketMiddWareMap=new Array,__reflect(SocketUtil.prototype,"SocketUtil");var PlayerButtonContainer=function(e){function t(t,r){var i=e.call(this)||this,n=RES.getRes("layout_json").playerButtonContainer;return i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height,i.show(t,r),i}return __extends(t,e),t.prototype.show=function(e,t){if(0==t){var r=new Button("pass",250,0,200,80);r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buttonBuJiao,e),this.addChild(r);var i=new TextTip("不叫",286,6,64);this.addChild(i);var n=new Button("ok",550,0,200,80);n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buttonJiaoDiZhu,e),this.addChild(n);var o=new TextTip("叫地主",554,6,64);this.addChild(o)}else if(1==t){var r=new Button("pass",250,0,200,80);r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buttonBuQiang,e),this.addChild(r);var i=new TextTip("不抢",286,6,64);this.addChild(i);var n=new Button("ok",550,0,200,80);n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buttonQiangDiZhu,e),this.addChild(n);var o=new TextTip("抢地主",554,6,64);this.addChild(o)}else if(2==t){var a=new Button("pass",100,0,200,80);a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buttonBuYao,e),this.addChild(a);var s=new TextTip("不要",136,6,64);this.addChild(s);var r=new Button("pass",400,0,200,80);r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buttonTiShi,e),this.addChild(r);var i=new TextTip("提示",436,6,64);this.addChild(i);var n=new Button("ok",700,0,200,80);n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,e.buttonChuPai,e),this.addChild(n);var o=new TextTip("出牌",736,6,64);this.addChild(o)}},t}(egret.DisplayObjectContainer);__reflect(PlayerButtonContainer.prototype,"PlayerButtonContainer");var PortraitOtherContainer=function(e){function t(t,r,i,n){var o=e.call(this)||this,a=RES.getRes("layout_json").portraitOtherContainer;i?o.x=a.leftX:o.x=a.rightX,o.y=a.y,o.width=a.width,o.height=a.height;var s=new egret.Shape;s.graphics.beginFill(1122867),s.graphics.drawRect(0,0,o.width,o.height),s.graphics.endFill(),s.alpha=.5,o.addChild(s);var h=new TextTip(t,0,100,32);if(h.width=100,o.addChild(h),n){var u=new TextTip("地主",100,0,32);u.width=100,o.addChild(u)}return o.show(r),o}return __extends(t,e),t.prototype.show=function(e){var t=new DefaultPortrait(e,0,0,100,100);this.addChild(t)},t}(egret.DisplayObjectContainer);__reflect(PortraitOtherContainer.prototype,"PortraitOtherContainer");var PukerBottomContainer=function(e){function t(t){var r=e.call(this)||this,i=RES.getRes("layout_json").pukerBottomContainer;r.x=i.x,r.y=i.y,r.width=i.width,r.height=i.height;var n=new egret.Shape;return n.graphics.beginFill(1122867),n.graphics.drawRect(0,0,r.width,r.height),n.graphics.endFill(),n.alpha=.5,r.addChild(n),r.show(t),r}return __extends(t,e),t.prototype.show=function(e){for(var t=RES.getRes("layout_json").puker,r=0,i=0;i<e.length;i++){var n=new Puker(e[i],r+i*t.pukerXSSpace,0,t.pukerXSWidth,t.pukerXSHeight);this.addChild(n)}},t}(egret.DisplayObjectContainer);__reflect(PukerBottomContainer.prototype,"PukerBottomContainer");var PukerContainer=function(e){function t(t,r){var i=e.call(this)||this,n=RES.getRes("layout_json").pukerContainer;i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height;var o=new egret.Shape;return o.graphics.beginFill(1122867),o.graphics.drawRect(0,0,i.width,i.height),o.graphics.endFill(),o.alpha=.3,i.addChild(o),i.show(t,r),i}return __extends(t,e),t.prototype.show=function(e,t){for(var r=RES.getRes("layout_json").puker,i=.5*(20-t.length)*r.pukerSpace,n=0;n<t.length;n++){var o=new Puker(t[n],i+n*r.pukerSpace,r.pukerUpMove,r.pukerWidth,r.pukerHeight);o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,e.pukerClick,e),this.addChild(o)}},t.prototype.removePukerByNames=function(e){for(var t=0;t<e.length;t++)null!=this.getChildByName(e[t]+"")&&this.removeChild(this.getChildByName(e[t]+""))},t}(egret.DisplayObjectContainer);__reflect(PukerContainer.prototype,"PukerContainer");var PukerOtherContainer=function(e){function t(t,r){var i=e.call(this)||this,n=RES.getRes("layout_json").pukerOtherContainer;r?i.x=n.leftX:i.x=n.rightX,i.y=n.y,i.width=n.width,i.height=n.height;var o=new egret.Shape;return o.graphics.beginFill(1122867),o.graphics.drawRect(0,0,i.width,i.height),o.graphics.endFill(),o.alpha=.5,i.addChild(o),i.show(t,r),i}return __extends(t,e),t.prototype.show=function(e,t){var r=RES.getRes("layout_json").puker,i=0;t||(i=(20-e.length)*r.pukerSmallSpace);for(var n=0;n<e.length;n++){var o=new Puker(e[n],i+n*r.pukerSmallSpace,0,r.pukerSmallWidth,r.pukerSmallHeight);this.addChild(o)}},t}(egret.DisplayObjectContainer);__reflect(PukerOtherContainer.prototype,"PukerOtherContainer");var PukerPlayContainer=function(e){function t(t){var r=e.call(this)||this,i=RES.getRes("layout_json").pukerPlayerContainer;r.x=i.x,r.y=i.y,r.width=i.width,r.height=i.height;var n=new egret.Shape;return n.graphics.beginFill(1127253),n.graphics.drawRect(0,0,r.width,r.height),n.graphics.endFill(),n.alpha=.3,r.addChild(n),r.show(t),r}return __extends(t,e),t.prototype.show=function(e){for(var t=RES.getRes("layout_json").puker,r=.5*(20-e.length)*t.pukerSpace,i=0;i<e.length;i++){var n=new Puker(e[i],r+i*t.pukerSpace,0,t.pukerWidth,t.pukerHeight);this.addChild(n)}},t}(egret.DisplayObjectContainer);__reflect(PukerPlayContainer.prototype,"PukerPlayContainer");var PukerVerticalContainer=function(e){function t(t,r){var i=e.call(this)||this,n=RES.getRes("layout_json").pukerVerticalContainer;r?i.x=n.leftX:i.x=n.rightX,i.y=n.y,i.width=n.width,i.height=n.height;var o=new egret.Shape;return o.graphics.beginFill(1122969),o.graphics.drawRect(0,0,i.width,i.height),o.graphics.endFill(),o.alpha=.5,i.addChild(o),i.show(t),i}return __extends(t,e),t.prototype.show=function(e){for(var t=RES.getRes("layout_json").puker,r=0,i=0,n=0;n<e.length;n++){n>=10&&(r=.3*t.pukerSmallHeight),i>=10&&(i-=10);var o=new Puker(e[n],r,i*t.pukerSmallSpace,t.pukerSmallWidth,t.pukerSmallHeight);i++,this.addChild(o)}},t}(egret.DisplayObjectContainer);__reflect(PukerVerticalContainer.prototype,"PukerVerticalContainer");var SpiderContainer=function(e){function t(t,r){var i=e.call(this)||this;i.layout=RES.getRes("layout_json").layout,i.x=0,i.y=100,i.width=900,i.height=400;var n=new egret.Shape;return n.graphics.beginFill(7833753),n.graphics.drawRect(0,0,i.width,i.height),n.graphics.endFill(),n.alpha=.3,i.addChild(n),i.show(t,r),i}return __extends(t,e),t.prototype.show=function(e,t){for(var r=0;r<e.length;r++){var i=new Puker(e[r],t+(r+1)*this.layout.pukerBigSpace,20,this.layout.pukerBigWidth,this.layout.pukerBigHeight);i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.pukerStartMove,this),i.addEventListener(egret.TouchEvent.TOUCH_END,this.pukerStopMove,this),this.addChild(i)}},t.prototype.pukerStartMove=function(t){this.draggedObject=t.currentTarget,this.offsetX=t.stageX-this.draggedObject.x,this.offsetY=t.stageY-this.draggedObject.y,this.addChild(this.draggedObject),console.log("dd:",e.prototype.getChildIndex.call(this,this.draggedObject)),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.pukerMove,this)},t.prototype.pukerMove=function(e){this.draggedObject.x=e.stageX-this.offsetX,this.draggedObject.y=e.stageY-this.offsetY},t.prototype.pukerStopMove=function(e){console.log("pukerClick: y:",this.draggedObject.y,this.draggedObject.name),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.pukerMove,this)},t}(egret.DisplayObjectContainer);__reflect(SpiderContainer.prototype,"SpiderContainer");var TextOtherContainer=function(e){function t(t,r){var i=e.call(this)||this,n=RES.getRes("layout_json").textOtherContainer;return r?i.x=n.leftX:i.x=n.rightX,i.y=n.y,i.width=n.width,i.height=n.height,i.show(t,r),i}return __extends(t,e),t.prototype.show=function(e,t){var r=0;t||(r=16+64*(6-e.length));var i=new TextTip(e,r,0,64);this.addChild(i)},t}(egret.DisplayObjectContainer);__reflect(TextOtherContainer.prototype,"TextOtherContainer");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(e){function t(){var t=e.call(this)||this;return t.randomNames=[{uid:"1001",name:"大可"},{uid:"1002",name:"Tiger"},{uid:"1003",name:"翔"},{uid:"1004",name:"傻源源"},{uid:"1005",name:"傻乐乐"},{uid:"1006",name:"小巴西"},{uid:"1007",name:"油烟机"},{uid:"1008",name:"可乐鸡翅"},{uid:"1009",name:"酸辣土豆丝"},{uid:"1010",name:"糖拌西红柿"},{uid:"1011",name:"拍黄瓜"},{uid:"1012",name:"空调没有遥控器"},{uid:"1013",name:"这么晚了还不回家"},{uid:"1014",name:"程咬金"},{uid:"1015",name:"猫砂不会盖"},{uid:"1016",name:"风扇不摇头"},{uid:"1017",name:"油炸花生米"},{uid:"1018",name:"电视不能看"},{uid:"1019",name:"绿萝"},{uid:"1020",name:"薄荷糖不麻"},{uid:"1021",name:"翔的小姐姐"},{uid:"1022",name:"孤单想吃西瓜"},{uid:"1023",name:"一个人看烟花"},{uid:"1024",name:"大海啊你全是水"},{uid:"1025",name:"骏马啊你四条腿"}],t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){egret.lifecycle.addLifecycleListener(function(e){e.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.receive=function(){return console.log("收到服务器数据--code:"),[]},t.prototype.createGameScene=function(){Socket.init("192.168.31.97",13e3),console.log("正在请求服务器... ...");var e=RES.getRes("layout_json").layout;this.stage.setContentSize(e.stageWidth,e.stageHeight),console.log("舞台大小：",this.stage.stageWidth,"*",this.stage.stageHeight);var t=new Button("ok",.5*this.stage.stageWidth-200,.5*this.stage.stageHeight-80,400,160);t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this),t.name="button",this.addChild(t);var r=new TextTip("进入房间",t.x+80,t.y+40,64);r.name="text",this.addChild(r)},t.prototype.startGame=function(e){var t=this,r=this.randomNames[Math.floor(Math.random()*this.randomNames.length)];Socket.start(r.uid,r.name,function(e){console.log("start ok:",e," user:",r),t.intoRoom(e.seat,e.gamers)}),console.log("已向Server请求开始游戏，等待Server分配房间...")},t.prototype.intoRoom=function(e,t){null!=this.getChildByName("button")&&this.removeChild(this.getChildByName("button")),null!=this.getChildByName("text")&&this.removeChild(this.getChildByName("text"));var r=new PlayerP2P_Single(e,t);this.addChild(r)},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,r=RES.getRes(e);return t.texture=r,t},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main",["SocketReceive"]);var Button=function(e){function t(t,r,i,n,o){var a=this,s="button_"+t+"_png";a=e.call(this,RES.getRes(s))||this,a.x=r,a.y=i,a.width=n,a.height=o,a.name=t+r;var h=new egret.Rectangle(60,30,80,20);return a.scale9Grid=h,a}return __extends(t,e),t}(egret.Bitmap);__reflect(Button.prototype,"Button");var SocketMiddWare=function(){function e(e){this.route=e}return e.prototype.middWare=function(e){console.log("data:",e),this.cb(e)},e.prototype.setCb=function(e){this.cb=e},e}();__reflect(SocketMiddWare.prototype,"SocketMiddWare");var Layout=function(e){function t(t,r){var i=e.call(this,RES.getRes("bg_jpg"))||this;return i.width=t,i.height=r,i.alpha=.3,i}return __extends(t,e),t}(egret.Bitmap);__reflect(Layout.prototype,"Layout");var Puker=function(e){function t(t,r,i,n,o){var a=this,s=t+"_jpg";return a=e.call(this,RES.getRes(s))||this,a.x=r,a.y=i,a.width=n,a.height=o,a.name=t+"",a}return __extends(t,e),t}(egret.Bitmap);__reflect(Puker.prototype,"Puker");var TextTip=function(e){function t(t,r,i,n){var o=e.call(this)||this;return o.x=r,o.y=i,o.textColor=16777215,o.size=n,o.fontFamily="KaiTi",o.textAlign=egret.HorizontalAlign.CENTER,o.text=t,o}return __extends(t,e),t}(egret.TextField);__reflect(TextTip.prototype,"TextTip");var PlayerP2C=function(e){function t(){var t=e.call(this)||this;t.pukerSelectArray=new Array,t.index=0,t.mySeat=1,t.landlordSeat=1,t.playingSeat=1,t.pukerUtil=new PukerUtils,t.pukers=t.pukerUtil.init(),t.pukers1=t.pukers.slice(0,17).sort(PukerUtils.sortDESC),t.pukers2=t.pukers.slice(17,34).sort(PukerUtils.sortDESC),t.pukers3=t.pukers.slice(34,51).sort(PukerUtils.sortDESC),t.pukers4=t.pukers.slice(51).sort(PukerUtils.sortDESC),t.playerPukers2=[17,21,25,29,33],t.layout=RES.getRes("layout_json").layout;var r=new Layout(t.layout.stageWidth,t.layout.stageHeight);return t.addChild(r),t.show(),t}return __extends(t,e),t.prototype.show=function(){this.puker=new PukerContainer(this,this.pukers1),this.puker.name="puker",this.addChild(this.puker),this.pukerVerticalRight=new PukerVerticalContainer(this.pukers2,!1),this.pukerVerticalRight.name="pukerVerticalRight",this.addChild(this.pukerVerticalRight),this.pukerVerticalLeft=new PukerVerticalContainer(this.pukers3,!0),this.pukerVerticalLeft.name="pukerVerticalLeft",this.addChild(this.pukerVerticalLeft),this.pukerBottom=new PukerBottomContainer(this.pukers4),this.pukerBottom.name="pukerBottom",this.addChild(this.pukerBottom),this.buttons=new PlayerButtonContainer(this,0),this.buttons.name="buttons",this.addChild(this.buttons),this.portraitLeft=new PortraitOtherContainer("小明",1,!0,!1),this.portraitLeft.name="portraitLeft",this.addChild(this.portraitLeft),this.portraitRight=new PortraitOtherContainer("小红",2,!1,!1),this.portraitRight.name="portraitRight",this.addChild(this.portraitRight),this.pukerLeft=new PukerOtherContainer(this.playerPukers2,!0),this.pukerLeft.name="pukerLeft",this.addChild(this.pukerLeft)},t.prototype.buttonChuPai=function(e){return PukerUtils.comparePukers(this.pukerSelectArray,this.playerPukers2)?(this.pukers1=PukerUtils.removeElements(this.pukers1,this.pukerSelectArray),null!=this.getChildByName("puker")&&this.removeChild(this.getChildByName("puker")),this.puker=new PukerContainer(this,this.pukers1),this.puker.name="puker",this.addChild(this.puker),null!=this.getChildByName("pukerPlay")&&this.removeChild(this.getChildByName("pukerPlay")),this.pukerPlay=new PukerPlayContainer(this.pukerSelectArray.sort(PukerUtils.sortDESC)),this.pukerPlay.name="pukerPlay",this.addChild(this.pukerPlay),void(this.pukerSelectArray=new Array)):void console.log("没有上家的牌大")},t.prototype.buttonBuJiao=function(e){console.log("不叫"),null!=this.getChildByName("pukerVerticalRight")&&this.removeChild(this.getChildByName("pukerVerticalRight")),this.pukerVerticalRight=new PukerVerticalContainer(this.pukers2.concat(this.pukers4).sort(PukerUtils.sortDESC),!1),this.pukerVerticalRight.name="pukerVerticalRight",this.addChild(this.pukerVerticalRight),null!=this.getChildByName("portraitRight")&&this.removeChild(this.getChildByName("portraitRight")),this.portraitRight=new PortraitOtherContainer("小红",2,!1,!0),this.portraitRight.name="portraitRight",this.addChild(this.portraitRight),null!=this.getChildByName("buttons")&&this.removeChild(this.getChildByName("buttons"))},t.prototype.buttonJiaoDiZhu=function(e){console.log("叫地主"),null!=this.getChildByName("puker")&&this.removeChild(this.getChildByName("puker")),this.puker=new PukerContainer(this,this.pukers1.concat(this.pukers4).sort(PukerUtils.sortDESC)),this.puker.name="puker",this.addChild(this.puker),null!=this.getChildByName("buttons")&&this.removeChild(this.getChildByName("buttons")),this.buttons=new PlayerButtonContainer(this,2),this.buttons.name="buttons",this.addChild(this.buttons)},t.prototype.buttonBuQiang=function(e){console.log("不抢")},t.prototype.buttonQiangDiZhu=function(e){console.log("抢地主")},t.prototype.buttonBuYao=function(e){console.log("不要")},t.prototype.buttonTiShi=function(e){console.log(PukerUtils.getType(this.pukerSelectArray))},t.prototype.pukerClick=function(e){var t=RES.getRes("layout_json").puker,r=t.pukerUpMove,i=e.currentTarget;i.y==r?(i.y=0,this.pukerSelectArray.push(parseInt(i.name))):(i.y=r,this.pukerSelectArray=PukerUtils.removeElements(this.pukerSelectArray,[parseInt(i.name)]))},t.prototype.timerFunc=function(){switch(this.index){case 0:this.puker=new PukerContainer(this,[54,53,2,15,28,41,1,14,27,13,26,39,11,24,10,9,8,7,6,5]),this.puker.name="puker",this.addChild(this.puker);break;case 1:this.puker.removePukerByNames([9,8,7,6,5]),this.pukerPlay=new PukerPlayContainer([9,8,7,6,5]),this.pukerPlay.name="pukerPlay",this.addChild(this.pukerPlay);break;case 2:this.pukerRight=new PukerOtherContainer([23,22,21,20,19],!1),this.pukerRight.name="pukerRight",this.addChild(this.pukerRight);break;case 3:this.textLeft=new TextOtherContainer("不要",!0),this.textLeft.name="textLeft",this.addChild(this.textLeft);break;case 4:this.puker.removePukerByNames([54,53]),this.removeChild(this.getChildByName("pukerPlay")),this.pukerPlay=new PukerPlayContainer([54,53]),this.pukerPlay.name="pukerPlay",this.addChild(this.pukerPlay);break;case 5:this.removeChild(this.getChildByName("pukerRight")),this.textRight=new TextOtherContainer("要不起",!1),this.textRight.name="textRight",this.addChild(this.textRight)}console.log("计时",this.index),this.index++},t.prototype.timerComFunc=function(){console.log("计时结束")},t}(egret.DisplayObjectContainer);__reflect(PlayerP2C.prototype,"PlayerP2C");var PlayerP2P_Single=function(e){function t(t,r){var i=e.call(this)||this;i.pukerSelectArray=new Array,i.index=0,i.pukerUtil=new PukerUtils,i.pukers=[],i.pukers1=[],i.pukers2=[],i.pukers3=[],i.pukers4=[],i.layout=RES.getRes("layout_json").layout,i.mySeat=t;var n=new Layout(i.layout.stageWidth,i.layout.stageHeight);if(i.addChild(n),i.show(),console.log("进入游戏房间，座位号:",i.mySeat,"其他人:",r),null!=r&&r.length>0)for(var o=0;o<r.length;o++)i.loadOtherPlayerPortrait(r[o].seat,r[o].name,!1);return i.receive(),i}return __extends(t,e),t.prototype.receive=function(){var e=this,t={route:"roomOtherJoinRoom",cb:function(t){console.log("有玩家进入房间"),e.loadOtherPlayerPortrait(t.seat,t.name,!1)}};SocketUtil.bind(t.route,t.cb)},t.prototype.loadOtherPlayerPortrait=function(e,t,r){this.isLeft(e)?(null!=this.getChildByName("portraitLeft")&&this.removeChild(this.getChildByName("portraitLeft")),null!=t&&(this.leftName=t),this.portraitLeft=new PortraitOtherContainer(this.leftName,1,!0,r),this.portraitLeft.name="portraitLeft",this.addChild(this.portraitLeft)):(null!=this.getChildByName("portraitRight")&&this.removeChild(this.getChildByName("portraitRight")),null!=t&&(this.leftName=t),this.portraitRight=new PortraitOtherContainer(this.leftName,2,!1,r),this.portraitRight.name="portraitRight",this.addChild(this.portraitRight))},t.prototype.isLeft=function(e){return 1==this.mySeat&&3==e?!0:2==this.mySeat&&1==e?!0:3==this.mySeat&&2==e?!0:!1},t.prototype.showButton=function(e){null!=this.getChildByName("buttons")&&this.removeChild(this.getChildByName("buttons")),this.buttons=new PlayerButtonContainer(this,e),this.buttons.name="buttons",this.addChild(this.buttons)},t.prototype.show=function(){Socket.notify("connector-entryHandler-ready",{reday:1}),console.log("正在请求服务器... ..."),this.portraitLeft=new PortraitOtherContainer("等待玩家连接",1,!0,!1),this.portraitLeft.name="portraitLeft",this.addChild(this.portraitLeft),this.portraitRight=new PortraitOtherContainer("等待玩家连接",2,!1,!1),this.portraitRight.name="portraitRight",this.addChild(this.portraitRight);var e=new DefaultPortrait(1,360,700,100,100);e.name="portrait",this.addChild(e)},t.prototype.buttonChuPai=function(e){console.log("出牌")},t.prototype.buttonBuJiao=function(e){console.log("不叫"),null!=this.getChildByName("buttons")&&this.removeChild(this.getChildByName("buttons"))},t.prototype.buttonJiaoDiZhu=function(e){console.log("叫地主"),null!=this.getChildByName("buttons")&&this.removeChild(this.getChildByName("buttons"))},t.prototype.buttonBuQiang=function(e){console.log("不抢"),null!=this.getChildByName("buttons")&&this.removeChild(this.getChildByName("buttons"))},t.prototype.buttonQiangDiZhu=function(e){console.log("抢地主"),null!=this.getChildByName("buttons")&&this.removeChild(this.getChildByName("buttons"))},t.prototype.buttonBuYao=function(e){console.log("不要")},t.prototype.buttonTiShi=function(e){console.log("提示")},t.prototype.pukerClick=function(e){var t=RES.getRes("layout_json").puker,r=t.pukerUpMove,i=e.currentTarget;i.y==r?(i.y=0,this.pukerSelectArray.push(parseInt(i.name))):(i.y=r,this.pukerSelectArray=PukerUtils.removeElements(this.pukerSelectArray,[parseInt(i.name)]))},t}(egret.DisplayObjectContainer);__reflect(PlayerP2P_Single.prototype,"PlayerP2P_Single");var PlayerP2P=function(){function e(){}return e}();__reflect(PlayerP2P.prototype,"PlayerP2P");var Boy=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.order=function(){var e=new DateEvent(DateEvent.DATE);e._year=2014,e._month=8,e._date=2,e._where="肯德基",e._todo="共进晚餐",this.dispatchEvent(e)},t}(egret.Sprite);__reflect(Boy.prototype,"Boy");var DateEvent=function(e){function t(t,r,i){void 0===r&&(r=!1),void 0===i&&(i=!1);var n=e.call(this,t,r,i)||this;return n._year=0,n._month=0,n._date=0,n._where="",n._todo="",n}return __extends(t,e),t}(egret.Event);DateEvent.DATE="约会",__reflect(DateEvent.prototype,"DateEvent");var Girl=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.getDate=function(e){console.log("得到了"+e.target.name+"的邀请！"),console.log("会在"+e._year+"年"+e._month+"月"+e._date+"日，在"+e._where+e._todo)},t}(egret.Sprite);__reflect(Girl.prototype,"Girl");var SampleDate=function(e){function t(){var t=e.call(this)||this,r=new Boy;r.name="男朋友";var i=new Girl;return i.name="女朋友",r.addEventListener(DateEvent.DATE,i.getDate,i),r.order(),r.removeEventListener(DateEvent.DATE,i.getDate,i),t}return __extends(t,e),t}(egret.DisplayObjectContainer);__reflect(SampleDate.prototype,"SampleDate");var T_globalToLocal=function(e){function t(){function t(){var e=i.globalToLocal(0,0);n.x=e.x,n.y=e.y}var r=e.call(this)||this,i=new egret.DisplayObjectContainer;i.x=200,i.y=200,r.addChild(i);var n=new egret.Shape;return n.graphics.beginFill(16711680),n.graphics.drawCircle(25,25,25),n.graphics.endFill(),i.addChild(n),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,t,r),r}return __extends(t,e),t}(egret.DisplayObjectContainer);__reflect(T_globalToLocal.prototype,"T_globalToLocal");var T_touchMove=function(e){function t(){function t(e){n=e.currentTarget,o=e.stageX-n.x,a=e.stageY-n.y,this.addChild(n),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,i,this)}function r(e){console.log(22),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,i,this)}function i(e){n.x=e.stageX-o,n.y=e.stageY-a}var n,o,a,s=e.call(this)||this,h=new egret.Shape;h.graphics.beginFill(16711680),h.graphics.drawCircle(25,25,25),h.graphics.endFill(),s.addChild(h);var u=new egret.Shape;return u.graphics.beginFill(255),u.graphics.drawRect(0,0,100,100),u.graphics.endFill(),s.addChild(u),h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t,s),h.addEventListener(egret.TouchEvent.TOUCH_END,r,s),u.touchEnabled=!0,u.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t,s),u.addEventListener(egret.TouchEvent.TOUCH_END,r,s),s}return __extends(t,e),t}(egret.DisplayObjectContainer);__reflect(T_touchMove.prototype,"T_touchMove");var PukerCompare=function(){function e(e,t){this.type=e,this.sort=t}return e.prototype.getType=function(){return this.type},e.prototype.getSort=function(){return this.sort},e}();__reflect(PukerCompare.prototype,"PukerCompare");var PukerUtils=function(){function e(){this.pukerValues=[1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,11,11,11,11,12,12,12,12,13,13,13,13,14,14]}return e.casePukers=function(t){for(var r=[],i=0;i<t.length;i++)for(var n=0;n<e.pukerIds.length;n++)t[i]==e.pukerIds[n]&&r.push(e.pukerOrderValues[n]);return r},e.sortASC=function(e,t){return e>t?1:t>e?-1:0},e.sortDESC=function(e,t){return e>t?-1:t>e?1:0},e.isBoom=function(t){return 4==t.length&&t[1]===t[0]&&t[2]===t[0]&&t[3]===t[0]?e.orderString.indexOf(t[0]):-1},e.isKingBoom=function(e){return 2==e.length&&"A"===e[0]&&"B"===e[1]?0:-1},e.isSingle=function(t){return 1==t.length?e.orderString.indexOf(t[0]):-1},e.isPair=function(t){return 2==t.length&&t[0]===t[1]?e.orderString.indexOf(t[0]):-1},e.isStraight=function(t){if(t.length<5||t.length>12)return-1;if(e.orderString.indexOf(t[0])<3)return-1;for(var r=0;r<t.length-1;r++)if(e.orderString.indexOf(t[r])+1!=e.orderString.indexOf(t[r+1]))return-1;return e.orderString.indexOf(t[0])},e.isThree=function(t){return 3!=t.length?-1:t[1]===t[0]&&t[2]===t[0]?e.orderString.indexOf(t[0]):-1},e.isThree_One=function(t){return 4!=t.length?-1:t[1]===t[0]&&t[2]===t[0]&&t[3]!=t[0]?e.orderString.indexOf(t[0]):t[1]===t[3]&&t[2]===t[3]&&t[0]!=t[3]?e.orderString.indexOf(t[1]):-1},e.isThree_Two=function(t){return 5!=t.length?-1:t[1]===t[0]&&t[2]===t[0]&&t[3]!=t[0]&&t[3]===t[4]?e.orderString.indexOf(t[0]):t[0]===t[1]&&t[2]===t[3]&&t[3]===t[4]&&t[0]!=t[2]?e.orderString.indexOf(t[2]):-1},e.isStraightPairs=function(t){if(t.length<6||t.length>20||t.length%2!=0)return-1;if(e.orderString.indexOf(t[0])<3)return-1;for(var r=0;r<t.length-1;r+=2)if(e.orderString.indexOf(t[r])!=e.orderString.indexOf(t[r+1]))return-1;for(var r=0;r<t.length-2;r+=2)if(e.orderString.indexOf(t[r])+1!=e.orderString.indexOf(t[r+2]))return-1;return e.orderString.indexOf(t[0])},e.isPlaneNoWing=function(t){return 6!=t.length?-1:e.orderString.indexOf(t[0])<3?-1:t[0]===t[1]&&t[1]===t[2]&&t[3]===t[4]&&t[4]===t[5]&&e.orderString.indexOf(t[0])+1===e.orderString.indexOf(t[3])?e.orderString.indexOf(t[0]):-1},e.isPlaneWing_Single=function(t){var r=[];if(8!=t.length)return-1;for(var i=0;i<t.length-2;i++)t[i]===t[i+1]&&t[i]==t[i+2]&&r.push(t[i]);return 2!=r.length?-1:e.orderString.indexOf(r[0])<3?-1:e.orderString.indexOf(r[0])+1===e.orderString.indexOf(r[1])?e.orderString.indexOf(r[0]):-1},e.isPlaneWing_pairs=function(t){var r=[],i=[];if(10!=t.length)return-1;for(var n=0;n<t.length-2;n++)t[n]===t[n+1]&&t[n]==t[n+2]&&i.push(t[n]),r=r.concat(e.removeElements(t,[t[n],t[n+1],t[n+2]]));if(2!=i.length)return-1;r=e.removeElements(t,r);for(var n=0;n<r.length-1;n+=2)if(r[n]!==r[n+1])return-1;return e.orderString.indexOf(i[0])<3?-1:e.orderString.indexOf(i[0])+1===e.orderString.indexOf(i[1])?e.orderString.indexOf(i[0]):-1},e.isFour_Single=function(t){if(6!=t.length)return-1;for(var r=0;r<t.length-3;r++)if(t[r]===t[r+1]&&t[r]===t[r+2]&&t[r]===t[r+3])return e.orderString.indexOf(t[r]);return-1},e.isFour_Pairs=function(t){var r,i=[];if(8!=t.length)return-1;for(var n=0;n<t.length-3;n++)t[n]===t[n+1]&&t[n]===t[n+2]&&t[n]===t[n+3]&&(i=i.concat(e.removeElements(t,[t[n],t[n+1],t[n+2],t[n+3]])),r=t[n]);for(var n=0;n<i.length-1;n+=2)if(i[n]!==i[n+1])return-1;return e.orderString.indexOf(r)},e.compareOne=function(t,r){var i=e.orderString;return i.indexOf(t)>-1&&i.indexOf(r)>-1&&i.indexOf(t)<i.indexOf(r)?!0:!1},e.comparePukers=function(t,r){var i=e.casePukers(t).sort(e.sortASC),n=e.casePukers(r).sort(e.sortASC);if(i.length<1||n.length<1)return!1;if(-1!=e.isKingBoom(n))return!1;if(-1!=e.isKingBoom(i))return!0;if(-1!=e.isBoom(n))return-1!=e.isBoom(i)?e.compareOne(i[0],n[0]):!1;if(-1!=e.isBoom(i))return!0;if(t.length!=r.length)return!1;var o=e.getType(t),a=e.getType(r);return null==o||null==a||o.getType()!=a.getType()?!1:o.getSort()<a.getSort()},e.seekRight=function(e,t){return[]},e.getType=function(t){var r=e.casePukers(t).sort(e.sortASC);return-1!=e.isBoom(r)?new PukerCompare("boom",e.isBoom(r)):-1!=e.isKingBoom(r)?new PukerCompare("kingBoom",e.isKingBoom(r)):-1!=e.isSingle(r)?new PukerCompare("single",e.isSingle(r)):-1!=e.isPair(r)?new PukerCompare("pair",e.isPair(r)):-1!=e.isThree(r)?new PukerCompare("three",e.isThree(r)):-1!=e.isThree_One(r)?new PukerCompare("three_one",e.isThree_One(r)):-1!=e.isThree_Two(r)?new PukerCompare("three_two",e.isThree_Two(r)):-1!=e.isStraight(r)?new PukerCompare("straight",e.isStraight(r)):-1!=e.isStraightPairs(r)?new PukerCompare("straightPairs",e.isStraightPairs(r)):-1!=e.isPlaneNoWing(r)?new PukerCompare("planeNoWing",e.isPlaneNoWing(r)):-1!=e.isPlaneWing_Single(r)?new PukerCompare("planeWing_single",e.isPlaneWing_Single(r)):-1!=e.isPlaneWing_pairs(r)?new PukerCompare("planeWing_pairs",e.isPlaneWing_pairs(r)):-1!=e.isFour_Single(r)?new PukerCompare("four_single",e.isFour_Single(r)):-1!=e.isFour_Pairs(r)?new PukerCompare("four_pairs",e.isFour_Pairs(r)):null
},e.compare=function(t,r){return t.length<1||r.length<1?!1:e.isKingBoom(r)?!1:e.isKingBoom(t)?!0:e.isBoom(r)?e.isBoom(t)?e.compareOne(t[0],r[0]):!1:e.isBoom(t)?!0:t.length!=r.length?!1:1==t.length?e.compareOne(t[0],r[0]):2==t.length?e.isPair(t)&&e.isPair(r)?e.compareOne(t[0],r[0]):!1:void 0},e.prototype.init=function(){for(var t,r,i=e.pukerIds.length,n=e.pukerIds.slice(),o=[],a=0;a<e.pukerIds.length;a++)t=Math.floor(Math.random()*n.length),r=n[t],o.push(r),n=e.slice(n,0,t).concat(e.slice(n,t+1,n.length)),i--;return console.log(o.toString()),o},e.slice=function(e,t,r){return 0>t||0>r||t>e.length||r>e.length?[]:e.slice(t,r)},e.removeElements=function(e,t){for(var r=0;r<t.length;r++)for(var i=0;i<e.length;i++)t[r]==e[i]&&(e=this.slice(e,0,i).concat(this.slice(e,i+1,e.length)));return e},e.findStraight=function(){var e=/5+6+7+8+9+/,t="34456667889";console.log("test:",e.test(t)?e.exec(t):"没有匹配项")},e.findThree=function(){var e=/7{3,}/,t="34577789";console.log("test:",e.test(t)?e.exec(t):"没有匹配项")},e.findPair=function(){var e=/7{2,}/,t="34577789";console.log("test:",e.test(t)?e.exec(t):"没有匹配项")},e}();PukerUtils.orderString="ABCDEFGHIJKLMNO",PukerUtils.pukerOrderValues=["D","D","D","D","C","C","C","C","O","O","O","O","N","N","N","N","M","M","M","M","L","L","L","L","K","K","K","K","J","J","J","J","I","I","I","I","H","H","H","H","G","G","G","G","F","F","F","F","E","E","E","E","B","A"],PukerUtils.pukerIds=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54],__reflect(PukerUtils.prototype,"PukerUtils");var GetConnection=function(){function e(){this.key="hall"}return e.prototype.receive=function(){return[]},e}();__reflect(GetConnection.prototype,"GetConnection",["SocketReceive"]);